<!DOCTYPE html>
<html lang="uk">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Автоматизована система управління геоданими - Модуль адресний реєстр</title>
		<link rel="icon" href="http://10.0.16.8/img/favicon/favicon.ico" type="image/x-icon">
		<!-- CSS FILES -->
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/uikit@latest/dist/css/uikit.min.css">
		<link rel="stylesheet" type="text/css" href="http://10.0.16.8/css/dashboard.css">
		<link rel="stylesheet" type="text/css" href="http://10.0.16.8/css/perfect-scrollbar.css">
		
        <!--Map CSS------------------>
        <link rel="stylesheet" href="http://10.0.16.8/lib/ol/ol.css" type="text/css">
        <link rel="stylesheet" href="http://10.0.16.8/lib/ol-layerswitcher/ol-layerswitcher.css" type="text/css">

		<!-- Scrollbar JS FILES -->
		<script src="http://10.0.16.8/js/perfect-scrollbar.js"></script>
		
		<!-- UIKIT JS FILES -->
		<script src="https://cdn.jsdelivr.net/npm/uikit@latest/dist/js/uikit.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/uikit@latest/dist/js/uikit-icons.min.js"></script>
        <!--Map JS------------------>
        <!-- <script src="http://10.0.16.8/lib/ol/ol.js" defer></script> -->
        <script src="http://10.0.16.8/lib/ol/ol.js"></script>
        
        <!-- <script src="https://openlayers.org/en/v5.3.0/build/ol.js"></script> -->
        <script src="http://10.0.16.8/lib/ol-layerswitcher/ol-layerswitcher.js"></script>		
		
		 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		 <script src="http://10.0.16.8/js/User.js"></script>
		 
		 <script src="http://10.0.16.8/js/Custom.js"></script>
		 
		 <link rel="stylesheet" href="http://10.0.16.8/css/select2.min.css" type="text/css">
		<script src="http://10.0.16.8/js/select2.min.js"></script>
		<script src="https://unpkg.com/axios/dist/axios.js"></script>
		<link rel="stylesheet" href="http://10.0.16.8/css/Custom.css" type="text/css">		
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
			<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.9.1/css/materialize/tabulator_materialize.css" rel="stylesheet">
		<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.8/dist/js/tabulator.min.js"></script>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.9.1/css/materialize/tabulator_materialize.css" rel="stylesheet">
		
		<script src="http://10.0.16.8/js/Docs.js"></script>
		
		
		<script type="text/javascript">
		$(function () {
		
		
		UIkit.offcanvas(document.getElementById("offcanvas-usage")).show();
		<!--UIkit.tooltip(document.getElementById("addAdr")).show();-->
		 $('#load').addClass("hide-loader");
		MainURL = "http://10.0.16.13:2023/portal/api/v1/register/";
		StreetType =[]; District = []; Authority=[]; DocumentType=[];
		STATUSES = [{id: 0 , name : 'Чинна' },{id: 1 , name : 'Зі змінами' },{id: 2 , name : 'Скасована' },{id: 3 , name : 'Чинність відновлена' }];
		STATUSESDOC = [{id: 0 , name : 'Дійсний' },{id: 1 , name : 'Анульований' },{id: 2 , name : 'Зі змінами' }];
		
		main = null;
		
		Document = {
		data: null,
		id: null,
		isStreet: true,
		CARD : {id:0, documentTypeId: null, authorityId: null, Documentstatus: null, number: '', issued: '', title: '', applicantName: '', applicantCode: '', documentUrl: '', comment: '', blob: null},
		CARDempty : {id:0, documentTypeId: null, authorityId: null, Documentstatus: null, number: '', issued: '', title: '', applicantName: '', applicantCode: '', documentUrl: '', comment: '', blob: null},
		URLGET: function f(type, id){ return `/${type}/${id}/document`;},
		URLGETS: function f(type, id){ return `/${type}/${id}/document`;},
		URLPOST: function f(type, id){ return `/${type}/${id}/document`;},
		URLPUT: "/document",
		URLDELETE: "/document"
		};
		
		Street = {
		data: null,
		CARD : {id: 0, aliasOne: "", aliasTwo: "", rightTopLatitude: 0, rightTopLongitude: 0, name: "", leftBottomLatitude: 0, leftBottomLongitude: 0, shortTypeName: "", typeId: 0, typeName: "", Streetstatus: null},
		CARDempty : {id: 0, aliasOne: "", aliasTwo: "", rightTopLatitude: 0, rightTopLongitude: 0, name: "", leftBottomLatitude: 0, leftBottomLongitude: 0, shortTypeName: "", typeId: 0, typeName: "", Streetstatus: null},
		URLGET: "/street",
		URLGETS: "/street",
		URLPOST: "/street",
		URLPUT: "/street",
		URLDELETE: "/street"
		};
		Address = {
		data: null,
		CARD : {id: 0, addressNumber: "", block: "", cadastre: "", description: "", districtId: 0, latitude: 0, longitude: 0, postCode: 0, status: 0, streetId: 0},
		CARDempty : {id: 0, addressNumber: "", block: "", cadastre: "", description: "", districtId: 0, latitude: 0, longitude: 0, postCode: 0, status: 0, streetId: 0},
		URLGET: "/address",
		URLGETS: "/address",
		URLPOST: "/address",
		URLPUT: "/address",
		URLDELETE: "/address"
		};
		getAdditionalyDataStatic(function after(){getAdditionalyData();});
		
		_tableDocument = gettabulator('', columnsDocument, true, null, '#tableSelectDoc');
		
		$('#Fileupload').on("change", function(){
		$('#file').text($('#Fileupload').val());
		});
		
		$('#modalCardAddAddress').on({

    'show.uk.modal': function(){
	
        let content; content = $('#map').detach();
		content.appendTo('#mapAddress');
		APP_MAP.refreshMap();
		APP_MAP.createAddress();
    },

    'hide.uk.modal': function(){
	 $('#load').removeClass("hide-loader");
	<!--UIkit.offcanvas(document.getElementById("offcanvas-usage")).show();-->
	let content;
        content = $('#map').detach();
		content.appendTo('#divmap');
		APP_MAP.refreshMap();
		APP_MAP.stopEditor();
		 $('#load').addClass("hide-loader");
    }
});
		$('#modalCardAddStreet').on({

    'show.uk.modal': function(){
	
        let content; content = $('#map').detach();
		content.appendTo('#mapStreet');
		APP_MAP.refreshMap();

    },

    'hide.uk.modal': function(){
	 $('#load').removeClass("hide-loader");
	<!--UIkit.offcanvas(document.getElementById("offcanvas-usage")).show();-->
	let content;
        content = $('#map').detach();
		content.appendTo('#divmap');
		APP_MAP.refreshMap();
		 $('#load').addClass("hide-loader");
    }
});

		});
		async function getAdditionalyDataStatic(after) {
            try {
				 $('#load').removeClass("hide-loader");
				let m  = await axios.get(MainURL + getCity()).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
				
				main = m.data;
                if(main)
				{
					forEachClassName("citytitle", i => i.textContent= main.cityName);
					forEachClassName("maintitle", i => i.textContent= main.title);
					forEachClassName("custom-logo", i => i.setAttribute('src', main.logoUrl));
					
					$('#countStreettext').text(' - ' + main.streetCount);
				$('#countStreet').val(main.streetCount);
				$('#countAddresstext').text(' - ' + main.addressCount);
				$('#countAddress').val(main.addressCount);
				}
				
				
				APP_MAP.selectStreet({rightTopLatitude:  main.rtLatitude ,
				rightTopLongitude:  main.rtLongitude ,
				leftBottomLatitude:  main.lbLatitude ,
				leftBottomLongitude:  main.lbLongitude });
				
				CONFIG_MAP.Map.maxExtent = [main.lbLatitude, main.lbLongitude, main.rtLatitude, main.rtLongitude];
				
				const x = await axios.get(MainURL + getCity()+"/district").catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
                District = x.data;
				fillSelect('districtId', District, "id", "name");
				
				const y = await axios.get(MainURL + getCity()+"/streetype").catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
                StreetType = y.data;
				fillSelect('typeId', StreetType, "id", "typeName");
				
				
				const yy = await axios.get(MainURL + getCity()+"/documenttype").catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
				DocumentType =  yy.data;
				fillSelect('documentTypeId', yy.data, "id", "typeName");
				
				const zz = await axios.get(MainURL + getCity()+"/authority").catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
				Authority= zz.data;
				fillSelect('authorityId', zz.data, "id", "name");
				
				fillSelect('Documentstatus', STATUSESDOC, "id", "name");
				fillSelect('Streetstatus', STATUSES, "id", "name");
				fillSelect('status', STATUSES, "id", "name");
				
				after();
            }
            catch {
                UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
            }

        }
		async function getAdditionalyData() {
		
            try {
				 $('#load').removeClass("hide-loader");
				
				const x = await axios.get(MainURL + getCity()+"/street").catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
                Street.data = x.data.filter(a=> a.id);
				Street.data.forEach(function (i) { i.fullname = i.name + ", " + i.shortTypeName});
				
				fillSelect('streetId', Street.data, "id", "fullname");
				
				$('#streetId').select2({
				 inputTooShort: "Пошук (введіть від трьох літер)",
					minimumInputLength: 3,
					minimumResultsForSearch: 20 // at least 20 results must be displayed
				});

				
				 $('#load').addClass("hide-loader");
				searchStreet($('#search').val());
				
				
            }
            catch {
			 $('#load').addClass("hide-loader");
                UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
            }

        }
		function selectingStreetTr(id){
		removeSelectStreetTr();
		$('#street'+id).addClass("uk-active");
		}
		
		
		function getSelectStreet(){
		let  element = document.getElementsByClassName("streettr uk-active");
		return element.length > 0 ? +element[0].id.replace('street','') : null;
		}
		
		
		function removeSelectStreetTr(){
		forEachClassName("streettr uk-active", i => i.classList.remove("uk-active"));
		}
		function hideShowIconSearch(search){
		if(search.length != 0){
			$('#iconSearch').addClass('uk-hidden');
			$('#iconClose').removeClass('uk-hidden');
		}
		else
		{
			$('#iconSearch').removeClass('uk-hidden');
			$('#iconClose').addClass('uk-hidden');
		}
		}
		function searchStreet(search){
			 $('#load').removeClass("hide-loader");
			<!--removeSelectStreetTr();-->
			if(search.length > 2){
			<!--let arrayOfStrings = search.split(" ");-->
			let obj = {...Street.data};
			let obj1 = [], obj2=[];
		
				obj1 = Object.values(obj).filter(a => (a.name).toUpperCase().indexOf(search.toUpperCase())==0);
				obj2 = Object.values(obj).filter(a => (a.name + " " + a.aliasOne+" " + a.aliasTwo).toUpperCase().indexOf(search.toUpperCase())>0);
		
			<!--arrayOfStrings.forEach(function (Item) {-->
				<!--obj1 = Object.values(obj).filter(a => (a.name).toUpperCase().indexOf(Item.toUpperCase())==0);-->
				<!--obj2 = Object.values(obj).filter(a => (a.name + " " + a.aliasOne+" " + a.aliasTwo).toUpperCase().indexOf(Item.toUpperCase())>0);-->
				<!--});-->
				
				if(obj1.length==0 && obj2.length==0)
				{
					do {
					  search = search.slice(0, -1);
					  obj2 = Object.values(obj).filter(a => (a.name + " " + a.aliasOne+" " + a.aliasTwo).toUpperCase().indexOf(search.toUpperCase())==0).concat(Object.values(obj).filter(a => (a.name + " " + a.aliasOne+" " + a.aliasTwo).toUpperCase().indexOf(search.toUpperCase())>0));

					} while (search.length > 1 && obj2.length == 0);
					
				}
				paintStreet(obj1, false, obj2);
				$('#CountStreet').text('знайдено ' + obj1.length);
			}
			if(search.length==0)
			{
			    <!--$('#CountStreet').text('100 з ' + Street.data.length);-->
				$('#CountStreet').text('');
				paintStreet(Street.data.slice(0, 150), Street.data.length > 150 ? true: false);
			}
			document.getElementById("search").focus();
			 $('#load').addClass("hide-loader");
		}
		function paintStreet(data, first, datasecond){
		 $('#load').removeClass("hide-loader");
		$("#tbodyStreet").empty();
		$("#container333").animate({ scrollTop: 0 }, "fast");
		data.forEach(function (Item) {
		$('#tbodyStreet').append(`<tr class="uk-visible-toggle streettr" id="street${Item.id}" ><td class=" ${Item.status == 2 ? 'line-through': ''}" onclick='getAddresses(${Item.id})'>${Item.fullname}</td>
										<td class="uk-text-nowrap uk-preserve-width"><a onclick=' getInfoStreet(${Item.id})' class="uk-margin-small-right uk-invisible-hover" uk-icon="info"></a><a onclick=' getStreet(${Item.id})' class="uk-margin-small-right uk-invisible-hover registryRole" uk-icon="pencil"></a>
										</td></tr>`);
            });
			<!--if(data.length ==0){-->
			<!--$('#tbodyStreet').append(`<tr><td>Не знайдено</td>-->
										<!--<td></td></tr>`);-->
			<!--}-->
			if(datasecond && datasecond.length>0){
			$('#tbodyStreet').append(`<tr class="uk-text-meta uk-margin-small-top underline uk-text-italic" ><td colspan=2 style='padding-top: 25px;'>Можливо Ви шукали:</td></tr>`);
			
			datasecond.forEach(function (Item) {
		$('#tbodyStreet').append(`<tr class="uk-visible-toggle streettr" id="street${Item.id}" ><td class=" ${Item.status == 2 ? 'line-through': ''}" onclick='getAddresses(${Item.id})'>${Item.fullname}</td>
										<td class="uk-text-nowrap uk-preserve-width"><a onclick=' getInfoStreet(${Item.id})' class="uk-margin-small-right uk-invisible-hover" uk-icon="info"></a><a onclick=' getStreet(${Item.id})' class="uk-margin-small-right uk-invisible-hover registryRole" uk-icon="pencil"></a>
										</td></tr>`);
            });
			}
			if(first){
			$('#tbodyStreet').append(`<tr class="uk-text-meta" ><td colspan=2>Для відображення інших вулиць скористуйтесь пошуком</td></tr>`);
			}
			
			removeelement(['registryRole'], 'registryRole');
			 $('#load').addClass("hide-loader");
		}
		
		function getstatus(id)
		{
		
		return STATUSES.find(a=> a.id == id) ? STATUSES.find(a=> a.id == id).name : "?";
		}
		function getFullAdr(adr){
		
		let s = Street.data.find(a=> a.id == adr.streetId);
		return (s.shortTypeName + " " +  s.name+ ", " + adr.addressNumber + (adr.block !='' ? (" корп." + adr.block) : ""));
		}
		async function getPoint(id){
		try {
				 $('#load').removeClass("hide-loader");
				let adr = Address.data.find(a=> a.id == id);
				
				if (adr){
				
				let d = District.find (a=> a.id == adr.districtId);
				
				let content = `<div class="">
    <div class="uk-grid-small uk-grid-match uk-flex-top uk-margin-remove uk-visible-toggle" uk-grid>
					  <div class="uk-width-1-1">
						<ul class="uk-nav uk-nav-default">
							<li class="uk-nav-header uk-text-primary">${getFullAdr(adr)}</li>
						  <li class="uk-nav-divider"></li>
							<li>Статус: <span class='uk-text-secondary'>${getstatus(adr.status)}</span></li>
							<li>Район: <span class='uk-text-secondary'>${d ? d.name : ""}</span></li>
							<li>Індекс: <span class='uk-text-secondary'>${adr.postCode}</span></li>
							<li>Кадастровий номер: <span class='uk-text-secondary'>${adr.cadastre}</span></li>
						</ul>
					</div>
					  </div>
    <div uk-drop='pos: right-center' class='uk-drop uk-drop-small'>
        <div class="uk-card uk-card-body uk-card-default uk-padding-small" style='left: -60px;'>
		<a onclick='getInfoAddress(${adr.id})' uk-icon="icon: info"></a><a class='registryRole' onclick='getAddress(${adr.id})' uk-icon="icon: pencil"></a></div>
    </div>
</div>`;
				APP_MAP.selectAddress({... Address.data.find(a=> a.id == id), html: content});
				
				removeelement(['registryRole'], 'registryRole');
				}
            }
            catch {
                UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
            }
			 $('#load').addClass("hide-loader");
		
		
		
		}
		
		async function getAddresses(idstreet){
		try {
				 $('#load').removeClass("hide-loader");
				let st = Street.data.find(a=> a.id == idstreet);
				if(st.rightTopLatitude == -1 && st.rightTopLongitude == -1 && st.leftBottomLatitude == -1 && st.leftBottomLongitude == -1)
				{
					APP_MAP.selectStreet({rightTopLatitude:  main.rtLatitude ,
					rightTopLongitude:  main.rtLongitude ,
					leftBottomLatitude:  main.lbLatitude ,
					leftBottomLongitude:  main.lbLongitude });
					 UIkit.notification({ message: 'Координати не знайдено', status: 'warning' });
					}
				else
				{
				APP_MAP.selectStreet(st);
					
				}
				
				const a = await axios.get(MainURL + getCity()+ "/street/" + idstreet + Address.URLGET).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
				Address.data = a.data;
				paintAddress(a.data);
				selectingStreetTr(idstreet);
            }
            catch {
                UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
            }
			 $('#load').addClass("hide-loader");
		
		
		
		}
		async function updateStreet(){
		var c = getCardData(Street.CARD, "Street");
        if (c) {
		let r = APP_MAP.getCurrentMapExtent();
		c.rightTopLatitude = r[3];
		c.rightTopLongitude = r[2];
		c.leftBottomLatitude = r[1];
		c.leftBottomLongitude = r[0];
		c.status = c.Streetstatus;
		c.linksToDo = getlinksunlinks();
		let id = Street.CARD.id;
		let token = gettoken();
			if(id == 0)
		{
			await saveobject(MainURL + getCity()+Street.URLPOST, c, token, "POST", function before(){
			}, function after() {getAdditionalyData(); hideModal('modalCardAddStreet')});
		}
		else{
		
			await saveobject(MainURL + getCity()+Street.URLPUT + "/" + id, c, token, "PUT", function before(){},
			 function after() {getAdditionalyData(); hideModal('modalCardAddStreet')});
		}
		
            
        }
	}
		
		async function updateAddress(){
		var c = getCardData(Address.CARD, "Address");
		if(c.latitude == 0 || c.longitude == 0 ){
		UIkit.notification({ message: 'Потрібно позначити місце розташування на карті', status: 'danger' });
		return;
		}
        if (c) {
		let id = Address.CARD.id;
		c.linksToDo = getlinksunlinks();
		let token = gettoken();
			if(id == 0)
		{
			await saveobject(MainURL + getCity()+Address.URLPOST, c, token, "POST", function before(){
			}, function after() {if(getSelectStreet() == c.streetId) { getAddresses(c.streetId);} hideModal('modalCardAddAddress')});
		}
		else{
		
			await saveobject(MainURL + getCity()+Address.URLPUT + "/" + id, c, token, "PUT", function before(){},
			 function after() {if(getSelectStreet() == c.streetId) { getAddresses(c.streetId);} hideModal('modalCardAddAddress')});
		}
		
            
        }
	}
		
		
		function paintAddress(data){
		$("#tbodyAddress").empty();
		$("#container444").animate({ scrollTop: 0 }, "fast");
		data.forEach(function (Item) {
		$('#tbodyAddress').append(`<span class="uk-badge ${Item.status == 2 ? 'line-through': ''}" onclick='getPoint(${Item.id})'>${Item.addressNumber + (Item.block !='' ? (" корп." + Item.block) : "")}</span>`);
            });
			if(data.length ==0){
			$('#tbodyAddress').append(`<span>Не знайдено</span>`);
			}
		}
		function getStreet(id) {
			transferal('gridStreet');
			GETDOCUMENTFROMDB('street', id);
			
        emptyformbyclass("Street");
        Street.CARD = Object.assign({}, Street.CARDempty);
        Street.CARD.id = id;
		
		
		
        if (Street.CARD.id != 0) {
			forEachClassName("delstreet", i => i.classList.remove("uk-hidden"));
            $('#h2modalStreet').text('Редагувати вулицю');
			Street.CARD = Street.data.find(a=> a.id == id);
			Street.CARD.Streetstatus = Street.CARD.status;
            getobject_ByData(Street.CARD, function before(){}, function after(){ 
			let st = Street.data.find(a=> a.id == id);
			if(st.rightTopLatitude == -1 && st.rightTopLongitude == -1 && st.leftBottomLatitude == -1 && st.leftBottomLongitude == -1)
				{
					APP_MAP.selectStreet({rightTopLatitude:  main.rtLatitude ,
					rightTopLongitude:  main.rtLongitude ,
					leftBottomLatitude:  main.lbLatitude ,
					leftBottomLongitude:  main.lbLongitude });
					 UIkit.notification({ message: 'Координати не знайдено', status: 'warning' });
					}
				else
				{
				APP_MAP.selectStreet(st);
					
				}
			
			showModal('modalCardAddStreet')});
        }
        else {
		forEachClassName("delstreet", i => i.className += ' uk-hidden');
            $('#h2modalStreet').text('Додати вулицю');
		showModal('modalCardAddStreet');
        }
		
    }
		function getAddress(id) {
		transferal('gridAddress');
		GETDOCUMENTFROMDB('address', id);
		
        emptyformbyclass("Address");
        Address.CARD = Object.assign({}, Address.CARDempty);
        Address.CARD.id = id;
        if (Address.CARD.id != 0) {
			forEachClassName("deladdress", i => i.classList.remove("uk-hidden"));
            $('#h2modalAddress').text('Редагувати адресу');
			Address.CARD = Address.data.find(a=> a.id == id);
            getobject_ByData(Address.CARD, function before(){}, function after(){getPoint(id); showModal('modalCardAddAddress')});
			
			
        }
        else {
		forEachClassName("deladdress", i => i.className += ' uk-hidden');
		$('#streetId').val(getSelectStreet()).trigger('change');
        $('#h2modalAddress').text('Додати адресу');
		showModal('modalCardAddAddress');
        }
		
    }
	function deleteStreet(){
	let token = gettoken();
	deleteobject(MainURL + getCity()+Street.URLDELETE + "/" + Street.CARD.id, null, token, function func(){ hideModal('modalCardAddStreet'); getAdditionalyData();});
	}
	function deleteAddress(){
	let token = gettoken();
	deleteobject(MainURL + getCity()+Address.URLDELETE + "/" + Address.CARD.id, null, token, function func(){ hideModal('modalCardAddAddress'); getAddresses(Address.CARD.streetId);});
	}
	async function getDocumentAddress(id)
	{
	try{
		let a = await axios.get((MainURL + getCity()+ "/address/"  +id + "/document"), {
				headers: {token: gettoken()}
			  }).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
		paintDocument(a.data);
		Document.data = a.data;
		Document.isStreet = false;
		Document.id = id;
		showModal('modalCardDoc');
		}
			catch{
			UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
			}
	}
	async function getDocumentStreet(id)
	{
	try{
			let a = await axios.get((MainURL + getCity()+ "/street/"  +id + "/document"), {
				headers: {token: gettoken()}
			  }).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
			paintDocument(a.data);
			Document.data = a.data;
			Document.isStreet = true;
			Document.id = id;
			showModal('modalCardDoc');
			}
			catch{
			UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
			}

	}
	
	function paintDocument(data){
		$("#tbodyDocument").empty();
		data.forEach(function (Item) {
							
							
							
		$('#tbodyDocument').append(`<tr>
		<td>${DocumentType.find(a=> a.id ==Item.documentTypeId) ?  DocumentType.find(a=> a.id ==Item.documentTypeId).typeName : ""} ${Authority.find(a=> a.id ==Item.authorityId) ?  Authority.find(a=> a.id ==Item.authorityId).name : ""} № ${Item.number} від ${getdate2(Item.issued)}р.</td>
		
										<td class="uk-text-nowrap uk-preserve-width">
										<a class="uk-margin-small-right" onclick="window.open('${Item.documentUrl}' , '_blank');" uk-icon="download"></a>
										
										</td></tr>`);
            });
			if(data.length==0){
			$('#tbodyDocument').append(`<tr colspan = 2><td>Не знайдено</td></tr>`);
			}
		}
		
		function getDocument(id){
		emptyformbyclass("Document");
		$('#Fileupload').val('');
		$('#file').text('Оберіть файл');
        Document.CARD = Object.assign({}, Document.CARDempty);
        Document.CARD.id = id;
        if (Document.CARD.id != 0) {
		$('#loaddoc').hide();
            $('#h2modalDocument').text('Редагувати документ');
			Document.CARD = Document.data.find(a=> a.id == id);
			Document.CARD.Documentstatus = Document.CARD.status;
            getobject_ByData(Document.CARD, function before(){}, function after(){showModal('modalCardAddDocument')});
			
        }
        else {
		$('#loaddoc').show();
        $('#h2modalDocument').text('Додати документ');
		showModal('modalCardAddDocument');
        }
		}
		
		async function updateDocument(){
		var c = getCardData(Document.CARD, "Document");
		if (c.id == 0 && document.getElementById('Fileupload').files[0] == undefined) {
		UIkit.notification({ message: 'Оберіть файл', status: 'danger' });
		return;
		}
        if (c) {
		let id = Document.CARD.id;
		let token = gettoken();
		
		var FD = new FormData();
        FD.append("authorityId", c.authorityId);
        FD.append("documentNumber", c.number);
		FD.append("documentTypeId", c.documentTypeId);
		FD.append("comment", c.comment);
		FD.append("applicantName", c.applicantName);
		FD.append("title", c.title);
		FD.append("applicantCode", c.applicantCode);
		FD.append("status", c.Documentstatus);
		FD.append("issuedDate", c.issued);
		
			if(id == 0)
		{
			FD.append("blob", $("#Fileupload").prop('files')[0]);
			
			await saveobjectFORMDATA(MainURL + getCity()+Document.URLPOST((Document.isStreet ? "street": "address") , Document.id), FD, token, "POST", function before(){
			}, function after() {if(Document.isStreet) getDocumentStreet(Document.id); else getDocumentAddress(Document.id);  hideModal('modalCardAddDocument')});
		}
		else{
		
			await saveobjectFORMDATA(MainURL + getCity()+Document.URLPUT + "/" + id, FD, token, "PUT", function before(){},
			 function after() {if(Document.isStreet) getDocumentStreet(Document.id); else getDocumentAddress(Document.id); hideModal('modalCardAddDocument')});
		}
		
            
        }
		}
		
		function deleteDoc(id){
	let token = gettoken();
	deleteobject(MainURL + getCity()+Document.URLDELETE + "/" + id, null, token, function func(){ if(Document.isStreet) getDocumentStreet(Document.id); else getDocumentAddress(Document.id);});
	}
	
	
	async function getInfoAddress(id){
		try{
		$('#info').empty();
		 $('#load').removeClass("hide-loader");
			let st = Address.data.find(a=> a.id == id);
			let a = await axios.get(MainURL + getCity()+ "/address/"  +id + "/document", {
				headers: {token: gettoken()}
			  }).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
			$('#info').append(`<div class="uk-card uk-card-default uk-margin-top uk-width-1-1">
    <div class="uk-card-header">
       <div class="uk-card-badge ${(st.status==0 || st.status==3) ?  'uk-label-success' : ((st.status==1) ?  'uk-label-warning' : ((st.status==2) ?  'uk-label-danger' : (uk-label-success)))} uk-label">${STATUSES.find(a=> a.id == st.status).name}</div>
	   
        <div class="uk-grid-small uk-flex-middle" uk-grid>
            
            <div class="uk-width-expand">
                <h3 class="uk-card-title uk-margin-remove-bottom">${getFullAdr(st)}</h3>
				<p class="uk-text-meta uk-margin-remove-bottom uk-margin-remove-top">зареєстровано ${getdate2(st.createdAt)}р.</p>
                <p class="uk-text-meta uk-margin-remove-top">обліковий номер ${st.id}</p>
            </div>
        </div>
    </div>
    <div class="uk-card-body">
<p><span class = 'uk-text-secondary'>Район:</span> ${District.find(a=> a.id == st.districtId).name} </p>
<p><span class = 'uk-text-secondary'>Кадастровий номер:</span> ${st.cadastre}</p>
<p><span class = 'uk-text-secondary'>Індекс:</span> ${st.postCode}</p>
      
        <h4 class='uk-legend uk-heading-bullet'>Документи</h4>
      <table class="uk-table uk-table-middle uk-table-divider uk-table-small" id='tbldoc'>
											
										</table>
    </div>
</div>`);

if(a.data.length>0){
$('#tbldoc').append(`<thead>
												<tr>
													<th class="uk-width-expand"></th>
													<th></th>
												</tr>
											</thead>
											<tbody id="tbodyDocument"></tbody>`);
											
											
											
											
            a.data.forEach(function (Item) {
			$('#tbodyDocument').append(`<tr>
		<td>${DocumentType.find(a=> a.id ==Item.documentTypeId) ?  DocumentType.find(a=> a.id ==Item.documentTypeId).typeName : ""} ${Authority.find(a=> a.id ==Item.authorityId) ?  Authority.find(a=> a.id ==Item.authorityId).nameInGenitiveCase : ""} № ${Item.number} від ${getdate2(Item.issued)}р.</td>
		
										<td class="uk-text-nowrap uk-preserve-width">
										<a class="uk-margin-small-right" onclick="window.open('${Item.documentUrl}' , '_blank');" uk-icon="download"></a>
										
										</td></tr>`);
            });
			}
			else{
			$('#tbldoc').append(`<p>Не знайдено</p>`);
			}
			showModal('modalInfo');
			}
			catch{
			UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
			}
			 $('#load').addClass("hide-loader");
	}
	
	
	
	async function getInfoStreet(id){
		try{
		$('#info').empty();
		 $('#load').removeClass("hide-loader");
			let st = Street.data.find(a=> a.id == id);
			
			let a = await axios.get(MainURL + getCity()+ "/street/"  +id + "/document", {
				headers: {token: gettoken()}
			  }).catch(error => {GETERROR(error); $('#load').addClass("hide-loader");});
			
			
			$('#info').append(`<div class="uk-card uk-card-default uk-margin-top uk-width-1-1">
    <div class="uk-card-header">
       <div class="uk-card-badge uk-label ${(st.status==0 || st.status==3) ?  'uk-label-success' : ((st.status==1) ?  'uk-label-warning' : ((st.status==2) ?  'uk-label-danger' : (uk-label-success)))} ">${STATUSES.find(a=> a.id == st.status).name}</div>
        <div class="uk-grid-small uk-flex-middle" uk-grid>
            
            <div class="uk-width-expand">
                <h3 class="uk-card-title uk-margin-remove-bottom">${StreetType.find(a=> a.id == st.typeId).typeName} ${st.name}</h3>
				<p class="uk-text-meta uk-margin-remove-top  uk-margin-remove-bottom">обліковий номер ${st.id}</p>
                <p class="uk-text-meta uk-margin-remove-top">зареєстровано ${getdate2(st.createdAt)}р.</p>
            </div>
        </div>
    </div>
    <div class="uk-card-body">
       <!--<div class="uk-grid-small uk-grid-match uk-flex-top  uk-child-width-1-2" uk-grid>
         <div>
         <div class="uk-card-default uk-card-body">
            <h3 class="uk-card-title">Аліас 1</h3>
            <p>${st.aliasOne}</p>
        </div>
      </div>
         <div>
         <div class="uk-card-default uk-card-body">
            <h3 class="uk-card-title">Аліас 2</h3>
            <p>${st.aliasTwo}</p>
        </div>
  </div>
  
  <h4 class='uk-legend uk-heading-bullet'>Історія</h4>
	  <div id='addrinfo'>
	  <p>У розробці</p>
        </div>-->
    
      
        <h4 class='uk-legend uk-heading-bullet'>Документи</h4>
      <table class="uk-table uk-table-middle uk-table-divider uk-table-small" id='tbldoc'>
											
										</table>
    </div>
</div>`);




if(a.data.length>0){
$('#tbldoc').append(`<thead>
												<tr>
													<th class="uk-width-expand"></th>
													<th></th>
												</tr>
											</thead>
											<tbody id="tbodyDocument"></tbody>`);
											
											
											
											
            a.data.forEach(function (Item) {
			$('#tbodyDocument').append(`<tr>
		<td>${DocumentType.find(a=> a.id ==Item.documentTypeId) ?  DocumentType.find(a=> a.id ==Item.documentTypeId).typeName : ""} ${Authority.find(a=> a.id ==Item.authorityId) ?  Authority.find(a=> a.id ==Item.authorityId).nameInGenitiveCase : ""} № ${Item.number} від ${getdate2(Item.issued)}р.</td>
		
										<td class="uk-text-nowrap uk-preserve-width">
										<a class="uk-margin-small-right" onclick="window.open('${Item.documentUrl}' , '_blank');" uk-icon="download"></a>
										
										</td></tr>`);
            });
			}
			else{
			$('#tbldoc').append(`<p>Не знайдено</p>`);
			}
			showModal('modalInfo');
			}
			catch{
			UIkit.notification({ message: 'Помилка! Дані не були завантажені', status: 'danger' });
			}
			 $('#load').addClass("hide-loader");
	}
		</script>
	</head>
	<body class='uk-invisible'>
	
	
	
 <div id="modalCardGETDOC" bg-close="false" class="uk-modal-container uk-flex-top" uk-modal="stack: true" uk-modal>
    <div class="uk-modal-dialog l uk-modal-body uk-margin-auto-vertical">
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
        <div class="uk-text-center">
            <div class="uk-overflow-auto">
							<div id="tableSelectDoc">
							</div>
						</div>
            <button class="uk-button uk-button-primary " onclick="SELECTDOC()" type="button">Обрати</button>
        </div>
    </div>
</div>
<div id="load" class="modalDialog " style="padding-left:calc(50% - 100px); padding-top:calc(50vh - 100px); overflow-y:auto; z-index:2000;position: fixed">
 <span uk-spinner="ratio: 7"></span>
		</div>
				<div id="modalCardAddDocument" bg-close="false" class="uk-modal-container uk-flex-top" uk-modal="stack: true">
    <div class="uk-modal-dialog m uk-modal-body uk-margin-auto-vertical" >
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
  
		<h1 class="uk-legend uk-heading-bullet" id="h2modalDocument"></h1>
        <div class="uk-grid-collapse  uk-flex-middle" uk-grid>
            <div class="uk-width-1-1">
    <div class="uk-grid-small uk-grid-match uk-flex-top uk-margin" uk-grid>
	<div class="uk-width-1-4@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Тип</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Document"  id="documentTypeId"></select>                       
      </div>
     </div>
	 <div class="uk-width-1-4@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Видавник</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Document"  id="authorityId"></select>                       
      </div>
     </div>
     <div class="uk-width-1-4@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Номер</label>
      <div class="uk-form-controls">
       <input class="uk-input necessarilytext Document" type="text" autocomplete="off" id="number">
      </div>
     </div>
	 <div class="uk-width-1-4@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Дата</label>
      <div class="uk-form-controls">
	  <input class="necessarilytext uk-input Document" type="date" id="issued">
      </div>
     </div>
	 <div class="uk-width-1-4@m">
      <label class="uk-form-label required_uk">Статус</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Document"  id="Documentstatus"></select>                       
      </div>
     </div>
	  <div class="uk-width-1-1">
      <label class="uk-form-label required_uk">Повна назва</label>
      <div class="uk-form-controls">
       <input class="uk-input necessarilytext Document" type="text" autocomplete="off" id="title">
      </div>
     </div>
	 <div class="uk-width-1-1">
	 <label class="uk-form-label">Заголовок</label>
      <div class="uk-form-controls">
	   <textarea class="uk-textarea Document" rows='2'  id="comment"></textarea>
      </div>
     </div>
	  
	
	 <!--<div class="uk-width-1-1">
      <label class="uk-form-label">Посилання</label>
      <div class="uk-form-controls">
       <input class="uk-input Document" type="text" autocomplete="off" id="documentUrl">
      </div>
     </div>-->
	 <div class="uk-width-1-1">
      <label class="uk-form-label">ПІБ заявника</label>
      <div class="uk-form-controls">
       <input class="uk-input Document" type="text" autocomplete="off" id="applicantName">
      </div>
     </div>
	 <div class="uk-width-1-1">
      <label class="uk-form-label">ЄДРПОУ заявника</label>
      <div class="uk-form-controls">
       <input class="uk-input Document" type="text" autocomplete="off" id="applicantCode">
      </div>
     </div>
	 
	 <div id='loaddoc' class="uk-width-1-1 uk-card uk-card-primary uk-card-small uk-card-body">
                                                    <label class="uk-form-label">Завантажити документ</label>
                                                    <div id="fileupload" class="uk-placeholder uk-text-center">
                                                        <div class="uk-width-1-1@s uk-margin-small-bottom" uk-form-custom>
                                                            <div class="js-upload" uk-form-custom>
                                                                <input type="file" id="Fileupload">
                                                                <button class="uk-button uk-width-1-1  uk-button-default" type="button" tabindex="-1" id="file">Оберіть файл</button>
                                                            </div>
                                                        </div>
                                                       
                                                    </div>
	</div>
     
     
     <div class="uk-width-1-1">
     <p class="uk-text-right">
    <button class="uk-button uk-button-primary " onclick="updateDocument()" type="button">Зберегти</button>
   </p>
   </div>
     
    </div>
            </div>
        </div>
    </div>
</div>
<div id="modalInfo" bg-close="false" class="uk-modal-container uk-flex-top" uk-modal="stack: true">
    <div class="uk-modal-dialog m uk-modal-body uk-margin-auto-vertical" >
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
        <div class="uk-grid-collapse  uk-flex-middle" uk-grid id='info'>
            
        </div>
    </div>
</div>
		<div id="modalCardDoc" bg-close="false" class="uk-modal-container uk-flex-top" uk-modal="stack: true">
    <div class="uk-modal-dialog l uk-modal-body uk-margin-auto-vertical" >
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
	<h1 class="uk-legend uk-heading-bullet">Документи</h1>
        <div class="uk-grid-collapse  uk-flex-middle" uk-grid>
            <div class="uk-width-1-1">
			<p uk-margin>
				<a class="uk-button uk-button-default" uk-tooltip="Додати новий документ" onclick='getDocument(0)'>Додати</a>
			</p>		
			<table class="uk-table uk-table-middle uk-table-divider uk-table-small" >
					<thead>
						<tr>
							<th class="uk-width-expand"></th>
							<th class="uk-width-auto"></th>
						</tr>
						</thead>
						<tbody id="tbodyDocument">										
						</tbody>
			</table>	
			</div>
        </div>
    </div>
</div>
		<div id="modalCardAddAddress" class="uk-modal-full"  uk-modal="stack: true">
    <div class="uk-modal-dialog">
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
  
        <div class="uk-grid-collapse  uk-flex-middle" uk-grid>
            <div class="uk-width-1-2@s" id="mapAddress" uk-height-viewport="offset-top: true"></div>
            <div class="uk-width-1-2@s uk-padding-large">
                <h1 class="uk-legend uk-heading-bullet" id="h2modalAddress"></h1>
    <div class="uk-grid-small uk-grid-match uk-flex-top uk-margin" uk-grid>
	<div class="uk-width-1-2@s">
      <label class="uk-form-label required_uk">Вулиця</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Address"  id="streetId"></select>                       
      </div>
     </div>
	 
     <div class="uk-width-1-4@s">
      <label class="uk-form-label required_uk">Номер</label>
      <div class="uk-form-controls">
       <input class="uk-input necessarilytext Address" type="text" autocomplete="off" id="addressNumber">
      </div>
     </div>
	 <div class="uk-width-1-4@s">
	 <label class="uk-form-label">Корпус</label>
      <div class="uk-form-controls">
       <input class="uk-input Address" type="text" autocomplete="off" id="block">
      </div>
     </div>
	 <div class="uk-width-1-3@s">
      <label class="uk-form-label required_uk">Статус</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Address"  id="status"></select>                       
      </div>
     </div>
	 <div class="uk-width-2-3@s">
      <label class="uk-form-label required_uk">Район</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Address"  id="districtId"></select>                       
      </div>
     </div>
	 <div class="uk-width-1-2@s">
	 <label class="uk-form-label">Кадастровий номер</label>
      <div class="uk-form-controls">
       <input class="uk-input Address" type="text" autocomplete="off" id="cadastre">
      </div>
     </div>
	 <div class="uk-width-1-2@s">
	 <label class="uk-form-label">Індекс</label>
      <div class="uk-form-controls">
       <input class="uk-input Address" type="text" autocomplete="off" id="postCode">
      </div>
     </div>
	 <!--<div class="uk-width-1-1">
	 <label class="uk-form-label">Додатково</label>
      <div class="uk-form-controls">
	   <textarea class="uk-textarea Address" rows='2'  id="description"></textarea>
      </div>
     </div>-->
	  
     <div id='gridAddress' class="uk-width-1-1">
	  </div>
     
     <div class="uk-width-1-1">
     <p class="uk-text-right">
    <button class="uk-button uk-button-default deladdress superRootRole" onclick="deleteAddress()" type="button">Видалити</button>
    <button class="uk-button uk-button-primary registryRole" onclick="updateAddress()" type="button">Зберегти</button>
   </p>
   </div>
     
    </div>
            </div>
        </div>
    </div>
</div>

<div id="modalCardAddStreet" class="uk-modal-full"  uk-modal="stack: true">
    <div class="uk-modal-dialog">
        <button class="uk-modal-close-full uk-close-large" type="button" uk-close></button>
  
        <div class="uk-grid-collapse  uk-flex-middle" uk-grid>
            <div class="uk-width-1-2@s" id="mapStreet" uk-height-viewport="offset-top: true"></div>
			
            <div class="uk-width-1-2@s uk-padding-large">
                <h1 class="uk-legend uk-heading-bullet" id="h2modalStreet"></h1>
    <div class="uk-grid-small uk-grid-match uk-flex-top uk-margin" uk-grid >
     <div class="uk-width-2-3@m">
      <label class="uk-form-label required_uk">Назва</label>
      <div class="uk-form-controls">
       <input class="uk-input necessarilytext Street" type="text" autocomplete="off" id="name">
      </div>
     </div>
     <div class="uk-width-1-6@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Тип</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Street"  id="typeId"></select>                       
      </div>
     </div>
	 <div class="uk-width-1-6@m uk-width-1-2@s">
      <label class="uk-form-label required_uk">Статус</label>
      <div class="uk-form-controls">
      <select class="uk-select necessarilyselect uk-width-1-1 Street"  id="Streetstatus"></select>                       
      </div>
     </div>
	 
     <div class="uk-width-1-1">
      <label class="uk-form-label">Аліаси</label>
      <div class="uk-form-controls">
       <textarea class="uk-textarea Street" rows='2'  id="aliasOne"></textarea>
      </div>
     </div>
     <!--<div class="uk-width-1-1">
      <label class="uk-form-label">Аліас 2</label>
      <div class="uk-form-controls">
       <textarea class="uk-textarea Street" rows='2'  id="aliasTwo"></textarea>
      </div>
     </div>-->
	 
	 <div class="uk-width-1-1" id='gridStreet'>
	  <div class="uk-width-1-1" id='divattDoc'>
	 <h4 class="uk-legend uk-heading-bullet uk-padding-small uk-padding-remove-top uk-padding-remove-bottom">Документи <a class="uk-margin-small-left " onclick="OpenDocModal();" uk-tooltip="title: Додати документ; delay: 500" uk-icon="plus"></a></h4>
            <div class="uk-width-1-1"><table class="uk-table uk-table-middle uk-table-divider uk-table-small" >
											<thead>
												<tr>
													<th class="uk-width-expand"></th>
													<th></th>
												</tr>
											</thead>
											<tbody id="tbodyDocuments">
																							
											</tbody>
										</table>
			</div>		
			</div>			
			</div>	
			
			
     <div class="uk-width-1-1">
     <p class="uk-text-right">
    <button class="uk-button uk-button-default delstreet superRootRole" onclick="deleteStreet()" type="button">Видалити</button>
    <button class="uk-button uk-button-primary registryRole" onclick="updateStreet()" type="button">Зберегти</button>
   </p>
   </div>
     
    </div>
            </div>
        </div>
    </div>
</div>
       
		<!--HEADER-->
		<header id="top-head" class="uk-position-fixed">
			<div class="uk-container uk-container-expand uk-background-default topbar">
				<nav class="uk-navbar uk-dark" data-uk-navbar="mode:click; duration: 250" style='height: 64px'>
				
					<div class="uk-navbar-left  uk-text-nowrap uk-text-truncate">
						<div class="   uk-text-truncate">
						<a class="uk-icon-button uk-hidden@m"  onclick="document.getElementById('left-col').toggleAttribute('hidden'); " data-uk-icon="icon: menu" title="Меню"></a>
						<a class="uk-icon-button" href="#offcanvas-usage" data-uk-icon="icon:more-vertical" title="Налаштування" uk-toggle></a>
						 <span class="uk-text-bold maintitle uk-margin-small-left "></span>
						
						</div>
					</div>				
				<div class="uk-navbar-right  uk-text-nowrap uk-text-truncate">
						<div class="uk-text-truncate">
						<a class="uk-link" uk-tooltip="title: Оберіть місто" href='cities.html'><span uk-icon="icon: location;"></span><span class="citytitle "></span></a>
						</div>
					</div>		
				</nav>
			</div>
		</header>
		<!--/HEADER-->
		<!-- LEFT BAR -->
		<aside id="left-col" class="uk-light  ">
			<div class="left-logo uk-flex uk-flex-middle content-box-dark">
			<!--<a class="uk-logo" href="#"><img class="custom-logo" src="img/logo.png" alt="">АСУ геоданими</a>-->
			<a class="uk-link-reset uk-flex uk-flex-middle" href="index.html">
				<img class="custom-logo" src="" alt=""><span class="uk-text-bold citytitle uk-margin-small-left"></span>
			</a>
			</div>
			
		
			<div class="left-nav-wrap">
				<ul class="uk-nav uk-nav-default uk-nav-parent-icon" data-uk-nav>
					<li class="uk-nav-header uk-heading-bullet">Адресний реєстр</li>
					<li class='uk-active'><a href="index.html"><span data-uk-icon="icon: search" class="uk-margin-small-right"></span>Пошук</a></li>
					<li   class='auditRole'><a href="audit.html"><span data-uk-icon="icon: file-edit" class="uk-margin-small-right"></span>Аудит</a></li>
					<li class='dictionaryRole'><a href="dictionaries.html"><span data-uk-icon="icon: thumbnails" class="uk-margin-small-right"></span>Довідники</a></li>
					<li   class='registryRole'><a href="documents.html"><span data-uk-icon="icon: album" class="uk-margin-small-right"></span>Документи</a></li>
					
					<li class='userRole'><a href="users.html"><span data-uk-icon="icon: users" class="uk-margin-small-right"></span>Користувачі</a></li>
					<!--<li  class='registryRole uk-disabled'><a href="#"><span data-uk-icon="icon: history" class="uk-margin-small-right"></span>Історія</a></li>-->
					<!--<li class='superRootRole uk-disabled'><a href="#"><span data-uk-icon="icon: cloud-upload" class="uk-margin-small-right"></span>Імпорт</a></li>-->
					<li class='exportImportRole'><a href="export.html"><span data-uk-icon="icon: cloud-download" class="uk-margin-small-right"></span>Експорт</a></li>

				</ul>
				
				<div class="left-content-box uk-margin-top">
					
						<h5>Статистика</h5>
						<div>
							<span class="uk-text-small">Кількість вулиць <small id='countStreettext'></small></span>
							<progress class="uk-progress" value="0" id='countStreet' max="5000"></progress>
						</div>
						<div>
							<span class="uk-text-small">Кількість адрес <small id='countAddresstext'></small></span>
							<progress class="uk-progress success" value="0" id='countAddress' max="150000"></progress>
						</div>
					
				</div>
				
			</div>
			<div class="bar-bottom">
				<ul class="uk-subnav uk-flex uk-flex-center uk-child-width-1-5" data-uk-grid>
					<li class='alluser'>
						<a href="index.html" class="uk-icon-link" data-uk-icon="icon: home" title="Головна" data-uk-tooltip></a>
					</li>
					<li class='superRootRole'>
						<a href="register.html" class="uk-icon-link" data-uk-icon="icon: settings" title="Налаштування" data-uk-tooltip></a>
					</li>
					<li class='alluser'>
						<a href="myaccount.html" class="uk-icon-link" data-uk-icon="icon: user" id='iam'  uk-tooltip="Обліковий запис" data-uk-tooltip></a>
					</li>
					
					<li class='alluser'>
						<a onclick="removetoken(); $(location).attr('href','index.html');" class="uk-icon-link" data-uk-tooltip="Вийти" data-uk-icon="icon: sign-out"></a>
					</li>
					<li class='user'>
						<a href="login.html" class="uk-icon-link" data-uk-tooltip="Авторизація" data-uk-icon="icon: sign-in"></a>
					</li>
				</ul>
			</div>
		</aside>
		<!-- /LEFT BAR -->
		<!-- CONTENT -->
		<div id="content" data-uk-height-viewport="expand: true">
		
		


<div id="offcanvas-usage" class="uk-padding-small uk-offcanvas-aside">

    <div class="aside-second uk-offcanvas-bar-light ">

        <!--<button class="uk-offcanvas-close" type="button" uk-close></button>-->

        <div class="uk-grid-collapse uk-flex uk-flex-middle "uk-grid>
		<div class="uk-width-expand">
		<form class="uk-search uk-search-default uk-width-1-1" uk-tooltip="title: Для пошуку потрібно ввести не менше трьох символів назви вулиці; delay: 500; pos: right" >
		<!--<span uk-search-icon></span>-->
		<input class="uk-input" type="text" autocomplete="off" oninput='hideShowIconSearch(this.value); searchStreet(this.value)' id='search'  placeholder="Пошук вулиці">
		
		<a class="uk-form-icon uk-form-icon-flip uk-hidden" id='iconClose' onclick="hideShowIconSearch(''); $('#search').val('').trigger('oninput')" uk-icon="icon: close"></a>
		<a class="uk-form-icon uk-form-icon-flip" id='iconSearch' uk-icon="icon: search"></a>
		</form>
		</div>
		<!--<div >
			<a class="uk-margin-small-left" href="" uk-icon="search"></a>
		</div>-->
		<div class='registryRole'>
			<a class="uk-margin-small-left " id='addAdr' onclick="getStreet(0)" uk-tooltip="title: Додати вулицю; delay: 500" uk-icon="plus"></a>
		</div>
		<div class='uk-width-1-1 uk-text-right'>
		<span id='CountStreet' class='uk-text-meta uk-text-italic'></span>
		</div>
        </div>
		
<div id="container333" class="uk-height-large uk-margin-small aside-second-first uk-margin-remove-top" style=" position:relative; top:0; bottom:0;"> 

	
<table class="uk-table uk-width-1-1 uk-table-small ">
    <thead class='uk-hidden'>
        <tr>
            <th class='uk-width-expand'></th>
            <th class='uk-preserve-auto'></th>
        </tr>
    </thead>
    <tbody id='tbodyStreet'>
    </tbody>
</table>
</div>
<hr class="uk-margin-small">

<h4 class="uk-heading-bullet uk-padding-small uk-margin-remove-top uk-padding-remove-top uk-padding-remove-bottom">Адреси<a class="uk-margin-small-left registryRole" id='addStr' onclick="getAddress(0)" uk-tooltip="title: Додати адресу; delay: 500" uk-icon="plus"></a></h4>
<div id="container444" class="uk-height-small aside-second-second" style=" position:relative; top:0; bottom:0;">
<div id='tbodyAddress'>


</div>
</div>

    </div>
</div>		
		


	
		
		
	<div class="uk-container uk-container-expand uk-padding-remove">

	<!--<div id="divmap" ><div id="map" class="map"></div></div> -->
	<div id="divmap" style="height: calc(100vh - 64px);"><div id="map" class="map" style="height: 100%;"></div>
	<div id="popup" class="ol-popup">
      <!--<a href="#" id="popup-closer" class="ol-popup-closer"></a>-->
      <div id="popup-content"></div>
    </div></div>

				

				<script src="http://10.0.16.8/js/editPanel_Map.js"></script>
				<script src="http://10.0.16.8/js/Config_Map.js"></script>
				<script src="http://10.0.16.8/js/Map.js"></script>
				<script src="http://10.0.16.8/js/Start_Map.js"></script>  

				<script type="text/javascript">
				//проверка тестовых функций карты
				//старт
					function ready() {
					  window.addEventListener("map_editpanel_changed",  function(e){
					  switch(e.detail.layer){
						case 'address':{
						  if (e.detail.action == 'add')
							APP_MAP.createAddress();
						  else if (e.detail.action == 'edit')
							APP_MAP.modifyAddress();
						  else 
							APP_MAP.removeAddress();
						}
						  break;
						case 'street' : {
						  if (e.detail.action == 'add')
							APP_MAP.createStreet();
						  else if (e.detail.action == 'edit')
							APP_MAP.modifyStreet();
						  else 
							APP_MAP.removeStreet();
						  }
							break;
						}
					  }, null);
					  MAP_EDITPANEL.initPanel();   

					function app_alert(e) {
					  //alert('кликнули по координатам ' + e.detail.coordinates)
					}
					window.addEventListener("map_singleclick",  app_alert, null);      
					
					//рисуем
					function app_draw_alert(e) {
					Address.CARD.longitude = e.detail.coordinates[0];
					Address.CARD.latitude = e.detail.coordinates[1];
					  //alert("нарисовано " + e.detail.coordinates)
					}
					window.addEventListener("map_drawend",  app_draw_alert, null); 

					//редактируем
					function app_modify_alert(e) {
					  alert("нарисовано " + e.detail.coordinates)
					}
					window.addEventListener("map_modifyend",  app_modify_alert, null);
					MAP_STARTER.start();
					}
					document.addEventListener("DOMContentLoaded", ready);
				//клик по карте
				 
				</script>
			
			
<!--
				<footer class="uk-section uk-section-small uk-text-center">
					<hr>
					<p class="uk-text-small uk-text-center">Всі права захищені 2021</p>
				</footer>
				-->
			</div>
		</div>
		<!-- /CONTENT -->
		<!-- OFFCANVAS -->
		
		<!-- /OFFCANVAS -->
	    <script>
    new PerfectScrollbar('#container333');
    new PerfectScrollbar('#container444');
    new PerfectScrollbar('#left-col');
    </script>	

	</body>
</html>
